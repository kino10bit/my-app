# タブナビゲーション 設計書

## 📋 概要

### 目的
アプリの主要機能へのアクセスを提供するメインナビゲーション。ユーザーが直感的にアプリの各エリアを行き来できるインターフェース。

### 構成概要
- **5つのタブ**: ホーム、探索、スタンプ、トレーナー、設定
- **ボトムナビゲーション**: 画面下部に固定表示
- **アイコン + ラベル**: 視覚的にわかりやすい表示
- **React Navigation**: Expo Routerによるタブナビゲーション

## 🎯 タブ構成

### 1. ホームタブ
```typescript
{
  name: "index",
  title: "ホーム",
  icon: "house.fill",
  component: SimpleDashboard
}
```
- **機能**: メインダッシュボード画面
- **内容**: 今日の進捗、目標一覧、統計情報
- **アイコン**: 家のアイコン（SF Symbols: house.fill）

### 2. 探索タブ
```typescript
{
  name: "explore",
  title: "探索", 
  icon: "plus.circle.fill",
  component: GoalCreateScreen
}
```
- **機能**: 新しい目標の作成・探索
- **内容**: 目標作成フォーム、カテゴリ選択
- **アイコン**: プラスアイコン（SF Symbols: plus.circle.fill）

### 3. スタンプタブ ⭐️ **NEW**
```typescript
{
  name: "stamps",
  title: "スタンプ",
  icon: "star.fill", 
  component: StampsScreen
}
```
- **機能**: 獲得したスタンプの確認
- **内容**: スタンプカード、統計、履歴
- **アイコン**: 星アイコン（SF Symbols: star.fill）

### 4. トレーナータブ
```typescript
{
  name: "trainer",
  title: "トレーナー",
  icon: "person.circle.fill",
  component: TrainerSelectionScreen  
}
```
- **機能**: トレーナーの選択・管理
- **内容**: トレーナー一覧、選択状態
- **アイコン**: 人物アイコン（SF Symbols: person.circle.fill）

### 5. 設定タブ
```typescript
{
  name: "settings",
  title: "設定",
  icon: "gearshape.fill",
  component: SettingsScreen
}
```
- **機能**: アプリ設定・各種調整
- **内容**: 通知設定、テーマ、データ管理
- **アイコン**: 歯車アイコン（SF Symbols: gearshape.fill）

## 🏗 実装構成

### ナビゲーション設定
```typescript
// app/(tabs)/_layout.tsx
export default function TabLayout() {
  return (
    <Tabs
      screenOptions={{
        tabBarActiveTintColor: Colors[colorScheme ?? 'light'].tint,
        headerShown: false,
      }}
    >
      <Tabs.Screen
        name="index"
        options={{
          title: 'ホーム',
          tabBarIcon: ({ color }) => <IconSymbol size={28} name="house.fill" color={color} />,
        }}
      />
      <Tabs.Screen
        name="explore"
        options={{
          title: '探索',
          tabBarIcon: ({ color }) => <IconSymbol size={28} name="plus.circle.fill" color={color} />,
        }}
      />
      <Tabs.Screen
        name="stamps"
        options={{
          title: 'スタンプ',
          tabBarIcon: ({ color }) => <IconSymbol size={28} name="star.fill" color={color} />,
        }}
      />
      <Tabs.Screen
        name="trainer"
        options={{
          title: 'トレーナー',
          tabBarIcon: ({ color }) => <IconSymbol size={28} name="person.circle.fill" color={color} />,
        }}
      />
      <Tabs.Screen
        name="settings"
        options={{
          title: '設定',
          tabBarIcon: ({ color }) => <IconSymbol size={28} name="gearshape.fill" color={color} />,
        }}
      />
    </Tabs>
  );
}
```

## 🎨 デザイン仕様

### 視覚デザイン
```
┌─────────────────────────────────────┐
│                                     │
│         メインコンテンツ             │
│                                     │
│                                     │
├─────────────────────────────────────┤
│ 🏠   🔍   ⭐   👤   ⚙️           │
│ホーム 探索 スタンプ トレーナー 設定    │
└─────────────────────────────────────┘
```

### カラーパレット
- **アクティブ色**: システムのティントカラー（通常は青 #007AFF）
- **非アクティブ色**: グレー #8E8E93
- **背景色**: システム背景（ライト/ダークモード対応）
- **境界線**: システム境界線色

### タイポグラフィ
- **ラベル**: システムフォント 10pt
- **アイコン**: 28x28pt
- **間隔**: 標準タブバー間隔

## 📱 インタラクション

### タップ操作
- **タブタップ**: 対応する画面へ遷移
- **同タブ再タップ**: 画面のトップへスクロール（将来実装）
- **ハプティック**: 軽い振動フィードバック

### 状態管理
- **アクティブ状態**: 現在表示中のタブを強調表示
- **バッジ表示**: 通知数やカウント表示（将来実装）
- **タブ切り替え**: スムーズなトランジション

## 🔄 画面遷移フロー

### 基本遷移
```
ホーム ←→ 探索 ←→ スタンプ ←→ トレーナー ←→ 設定
  ↓        ↓        ↓         ↓         ↓
詳細画面  目標作成  スタンプ詳細  選択画面   各種設定
```

### 特殊な遷移
- **ダッシュボード → スタンプ**: 完了ボタンからのアニメーション遷移
- **設定 → トレーナー**: 設定からのトレーナー選択
- **目標作成完了 → ホーム**: 作成完了後の自動遷移

## ⚡ パフォーマンス

### 最適化ポイント
- **遅延読み込み**: タブ初回アクセス時にコンテンツ読み込み
- **メモリ管理**: 非アクティブタブのメモリ解放
- **状態保持**: タブ切り替え時の状態維持

### ローディング戦略
```typescript
// タブ初回表示時の最適化
const TabComponent = () => {
  const [isInitialized, setIsInitialized] = useState(false);
  
  useFocusEffect(
    useCallback(() => {
      if (!isInitialized) {
        loadInitialData();
        setIsInitialized(true);
      }
    }, [isInitialized])
  );
};
```

## 🧪 アクセシビリティ

### VoiceOver対応
- **ラベル**: 各タブに適切なアクセシビリティラベル
- **ヒント**: タブの機能説明
- **状態**: アクティブ/非アクティブ状態の読み上げ

### 実装例
```typescript
<Tabs.Screen
  name="stamps"
  options={{
    title: 'スタンプ',
    tabBarIcon: ({ color }) => <IconSymbol size={28} name="star.fill" color={color} />,
    tabBarAccessibilityLabel: '獲得したスタンプを確認',
    tabBarAccessibilityHint: 'タップしてスタンプ画面を表示します',
  }}
/>
```

## 🔧 技術仕様

### 使用ライブラリ
- **@react-navigation/bottom-tabs**: ボトムタブナビゲーション
- **Expo Router**: ファイルベースルーティング
- **IconSymbol**: SF Symbols対応アイコンコンポーネント

### ファイル構造
```
app/(tabs)/
├── _layout.tsx          # タブレイアウト設定
├── index.tsx           # ホームタブ
├── explore.tsx         # 探索タブ  
├── stamps.tsx          # スタンプタブ ⭐️ NEW
├── trainer.tsx         # トレーナータブ
└── settings.tsx        # 設定タブ
```

## 🚀 将来の拡張

### 予定機能
- **バッジ表示**: 未読通知数の表示
- **カスタムアイコン**: ユーザーの好みに応じたアイコン変更
- **ショートカット**: 3D Touchによるクイックアクション
- **アニメーション**: タブ切り替え時の滑らかな遷移

### 実験的機能
- **スワイプナビゲーション**: 画面スワイプでのタブ切り替え
- **フローティングタブ**: 動的なタブバー位置調整
- **コンテキストメニュー**: タブ長押しでのメニュー表示

## 📊 使用状況分析

### 想定される利用パターン
1. **デイリーユース**: ホーム → スタンプ → ホーム
2. **目標設定**: 探索 → ホーム
3. **カスタマイズ**: 設定 → トレーナー
4. **振り返り**: スタンプ → 詳細確認

### KPI監視項目（将来実装）
- タブ別アクセス頻度
- 遷移パターン分析
- 滞在時間測定
- エラー発生率

---

*📝 Created: 2025-01-15 | 🔄 Last Updated: 2025-01-15*