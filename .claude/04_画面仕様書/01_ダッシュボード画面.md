# ダッシュボード画面仕様書

## 概要
Appcadiaアプリのメイン画面。ユーザーの今日の進捗、目標、トレーナーからのメッセージを一覧表示する。

## 画面構成

### レイアウト
```
┌─────────────────────────────┐
│ [設定]     Appcadia [avatar]│
├─────────────────────────────┤
│      おはようございます！      │
│                           │
│    今日の進捗 (70%)          │
│  ●●●●●○○○○○              │
│  完了: 2/5  残り: 3  70%     │
│                           │
│ 【今日のアクション】           │
│ ☑ 朝のランニング 30分 [完了済み]│
│ □ 英単語学習 20分    [完了]   │
│ □ 読書 1時間        [完了]   │
│                           │
│ 【あなたの記録】              │
│ 総スタンプ: 156  最高連続: 12 │
│ 現在の連続: 5日              │
│                           │
│ [トレーナー画像]              │
│ "今日も一緒に頑張りましょう！"  │
└─────────────────────────────┘
```

## 機能仕様

### 1. ヘッダー部
- **アプリ名**: "Appcadia" 表示
- **時間帯挨拶**: おはよう/こんにちは/こんばんは
- **トレーナーアバター**: 選択中トレーナーの画像

### 2. 進捗セクション
- **今日の達成率**: パーセンテージとプログレスバー
- **完了数/総数**: "2/5" 形式で表示
- **残りタスク数**: 未完了のタスク数

### 3. 今日のアクションリスト
- **タスク一覧**: 今日実行予定のアクション
- **完了状態**: ☑(完了) / □(未完了) アイコン
- **完了ボタン**: タップでスタンプ獲得
- **カテゴリ表示**: 各目標のカテゴリ

### 4. 統計表示
- **総スタンプ数**: 累計獲得スタンプ
- **最高連続記録**: 過去最高の連続達成日数
- **現在の連続記録**: 現在の連続達成日数
- **アクティブ目標数**: 現在設定中の目標数

### 5. トレーナーメッセージ
- **アバター画像**: トレーナーキャラクター
- **励ましメッセージ**: パーソナリティに応じたメッセージ
- **動的メッセージ**: 進捗に応じて変化

## UI/UX仕様

### カラーパレット
- **プライマリ**: #007AFF (iOS Blue)
- **成功**: #34C759 (Green)
- **警告**: #FF9500 (Orange)
- **背景**: #F5F5F5 (Light Gray)

### タイポグラフィ
- **タイトル**: 24pt, Bold
- **サブタイトル**: 14pt, Regular
- **ボディ**: 16pt, Medium
- **キャプション**: 12pt, Regular

### アニメーション
- **プログレスバー**: 0.5秒のスムーズアニメーション
- **スタンプ獲得**: バウンス + フェードイン効果
- **リフレッシュ**: プルトゥリフレッシュ対応

## 状態管理

### State Variables
```typescript
interface DashboardState {
  goals: GoalModel[]
  selectedTrainer: TrainerModel
  todayStamps: Set<string>
  statistics: {
    totalStamps: number
    currentStreak: number
    bestStreak: number
    activeGoals: number
  }
  isLoading: boolean
  refreshing: boolean
}
```

### Actions
- `loadDashboardData()`: 初期データ読み込み
- `handleCompleteGoal(goal)`: 目標完了処理
- `onRefresh()`: データ再取得

## ナビゲーション

### 遷移先画面
- **目標詳細**: 各アクションタップ
- **目標作成**: フローティングボタン
- **トレーナー画面**: アバタータップ
- **進捗詳細**: 統計セクションタップ
- **設定画面**: ヘッダーの設定ボタン

### 戻り方
- **タブナビゲーション**: 他タブから戻る
- **アプリ起動時**: デフォルト表示画面

## エラーハンドリング

### エラーケース
1. **ネットワークエラー**: オフライン時の対応
2. **データ取得失敗**: リトライ機能
3. **スタンプ処理失敗**: エラーメッセージ表示

### フォールバック
- **データなし**: 空状態画面表示
- **トレーナー未選択**: デフォルトメッセージ
- **目標なし**: 目標作成を促すメッセージ

## パフォーマンス

### 最適化ポイント
- **メモ化**: 統計計算結果のキャッシュ
- **遅延読み込み**: 重いコンポーネントの分離
- **プルトゥリフレッシュ**: 必要時のみデータ再取得

### キャッシュ戦略
- **Dashboard data**: 5分間キャッシュ
- **Statistics**: 目標数変更時まで保持
- **Trainer messages**: セッション中保持

## アクセシビリティ

### VoiceOver対応
- **進捗状況**: "今日の達成率70パーセント"
- **アクションボタン**: "朝のランニングを完了"
- **統計情報**: "総スタンプ156個獲得済み"

### Dynamic Type
- **フォントサイズ**: システム設定に対応
- **レイアウト**: テキストサイズ変更時の調整

## テスト仕様

### 単体テスト
- [ ] データ読み込み処理
- [ ] スタンプ獲得処理
- [ ] 統計計算処理
- [ ] エラーハンドリング

### 統合テスト
- [ ] 画面表示テスト
- [ ] ナビゲーションテスト
- [ ] リフレッシュ処理テスト

### UI テスト
- [ ] タップ操作テスト
- [ ] アニメーション確認
- [ ] 異なる画面サイズでの表示確認

## 実装メモ

### 技術スタック
- **React Native**: 画面描画
- **WatermelonDB**: データ永続化
- **React Context**: 状態管理
- **Performance Optimizer**: キャッシュ・最適化

### 既存実装
- `src/screens/SimpleDashboard.tsx`: メイン実装ファイル
- `src/context/AppContext.tsx`: 状態管理
- `src/utils/PerformanceOptimizer.tsx`: パフォーマンス最適化